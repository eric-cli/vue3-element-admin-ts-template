import{F as w}from"./FileSaver.min.41c9702c.js";import{w as x,u as b,S as l}from"./xlsx.5331d5b0.js";import"./vendor.a1ba0c3f.js";function A(o){for(var f=[],s=o.querySelectorAll("tr"),e=[],r=0;r<s.length;++r){for(var t=[],n=s[r],v=n.querySelectorAll("td"),u=0;u<v.length;++u){var g=v[u],p=g.getAttribute("colspan"),a=g.getAttribute("rowspan"),h=g.innerText;if(h!==""&&h==+h&&(h=+h),e.forEach(function(i){if(r>=i.s.r&&r<=i.e.r&&t.length>=i.s.c&&t.length<=i.e.c)for(var m=0;m<=i.e.c-i.s.c;++m)t.push(null)}),(a||p)&&(a=a||1,p=p||1,e.push({s:{r,c:t.length},e:{r:r+a-1,c:t.length+p-1}})),t.push(h!==""?h:null),p)for(var c=0;c<p-1;++c)t.push(null)}f.push(t)}return[f,e]}function d(o,f){f&&(o+=1462);var s=Date.parse(o);return(s-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function y(o,f){for(var s={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=o.length;++r)for(var t=0;t!=o[r].length;++t){e.s.r>r&&(e.s.r=r),e.s.c>t&&(e.s.c=t),e.e.r<r&&(e.e.r=r),e.e.c<t&&(e.e.c=t);var n={v:o[r][t]};if(n.v!=null){var v=b.encode_cell({c:t,r});typeof n.v=="number"?n.t="n":typeof n.v=="boolean"?n.t="b":n.v instanceof Date?(n.t="n",n.z=l._table[14],n.v=d(n.v)):n.t="s",s[v]=n}}return e.s.c<1e7&&(s["!ref"]=b.encode_range(e)),s}function S(){if(!(this instanceof S))return new S;this.SheetNames=[],this.Sheets={}}function _(o){for(var f=new ArrayBuffer(o.length),s=new Uint8Array(f),e=0;e!=o.length;++e)s[e]=o.charCodeAt(e)&255;return f}function D(o){var f=document.getElementById(o),s=A(f),e=s[1],r=s[0],t="SheetJS",n=new S,v=y(r);v["!merges"]=e,n.SheetNames.push(t),n.Sheets[t]=v;var u=x(n,{bookType:"xlsx",bookSST:!1,type:"binary"});w.exports.saveAs(new Blob([_(u)],{type:"application/octet-stream"}),"test.xlsx")}function F({multiHeader:o=[],header:f,data:s,filename:e,merges:r=[],autoWidth:t=!0,bookType:n="xlsx"}={}){e=e||"excel-list",s=[...s],s.unshift(f);for(let a=o.length-1;a>-1;a--)s.unshift(o[a]);var v="SheetJS",u=new S,g=y(s);if(r.length>0&&(g["!merges"]||(g["!merges"]=[]),r.forEach(a=>{g["!merges"].push(b.decode_range(a))})),t){const a=s.map(c=>c.map(i=>i==null?{wch:10}:i.toString().charCodeAt(0)>255?{wch:i.toString().length*2}:{wch:i.toString().length}));let h=a[0];for(let c=1;c<a.length;c++)for(let i=0;i<a[c].length;i++)h[i].wch<a[c][i].wch&&(h[i].wch=a[c][i].wch);g["!cols"]=h}u.SheetNames.push(v),u.Sheets[v]=g;var p=x(u,{bookType:n,bookSST:!1,type:"binary"});w.exports.saveAs(new Blob([_(p)],{type:"application/octet-stream"}),`${e}.${n}`)}export{F as export_json_to_excel,D as export_table_to_excel};
