import{F as w}from"./FileSaver.min.df1c4b23.js";import{w as x,u as b,S as l}from"./xlsx.5331d5b0.js";import"./vendor.25bcfe43.js";function A(i){for(var a=[],s=i.querySelectorAll("tr"),e=[],r=0;r<s.length;++r){for(var t=[],n=s[r],v=n.querySelectorAll("td"),u=0;u<v.length;++u){var g=v[u],p=g.getAttribute("colspan"),o=g.getAttribute("rowspan"),h=g.innerText;if(h!==""&&h==+h&&(h=+h),e.forEach(function(f){if(r>=f.s.r&&r<=f.e.r&&t.length>=f.s.c&&t.length<=f.e.c)for(var m=0;m<=f.e.c-f.s.c;++m)t.push(null)}),(o||p)&&(o=o||1,p=p||1,e.push({s:{r,c:t.length},e:{r:r+o-1,c:t.length+p-1}})),t.push(h!==""?h:null),p)for(var c=0;c<p-1;++c)t.push(null)}a.push(t)}return[a,e]}function d(i,a){a&&(i+=1462);var s=Date.parse(i);return(s-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function y(i,a){for(var s={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=i.length;++r)for(var t=0;t!=i[r].length;++t){e.s.r>r&&(e.s.r=r),e.s.c>t&&(e.s.c=t),e.e.r<r&&(e.e.r=r),e.e.c<t&&(e.e.c=t);var n={v:i[r][t]};if(n.v!=null){var v=b.encode_cell({c:t,r});typeof n.v=="number"?n.t="n":typeof n.v=="boolean"?n.t="b":n.v instanceof Date?(n.t="n",n.z=l._table[14],n.v=d(n.v)):n.t="s",s[v]=n}}return e.s.c<1e7&&(s["!ref"]=b.encode_range(e)),s}function S(){if(!(this instanceof S))return new S;this.SheetNames=[],this.Sheets={}}function _(i){for(var a=new ArrayBuffer(i.length),s=new Uint8Array(a),e=0;e!=i.length;++e)s[e]=i.charCodeAt(e)&255;return a}function D(i){var a=document.getElementById(i),s=A(a),e=s[1],r=s[0],t="SheetJS",n=new S,v=y(r);v["!merges"]=e,n.SheetNames.push(t),n.Sheets[t]=v;var u=x(n,{bookType:"xlsx",bookSST:!1,type:"binary"});w.exports.saveAs(new Blob([_(u)],{type:"application/octet-stream"}),"test.xlsx")}function F({multiHeader:i=[],header:a,data:s,filename:e,merges:r=[],autoWidth:t=!0,bookType:n="xlsx"}={}){e=e||"excel-list",s=[...s],s.unshift(a);for(let o=i.length-1;o>-1;o--)s.unshift(i[o]);var v="SheetJS",u=new S,g=y(s);if(r.length>0&&(g["!merges"]||(g["!merges"]=[]),r.forEach(o=>{g["!merges"].push(b.decode_range(o))})),t){const o=s.map(c=>c.map(f=>f==null?{wch:10}:f.toString().charCodeAt(0)>255?{wch:f.toString().length*2}:{wch:f.toString().length}));let h=o[0];for(let c=1;c<o.length;c++)for(let f=0;f<o[c].length;f++)h[f].wch<o[c][f].wch&&(h[f].wch=o[c][f].wch);g["!cols"]=h}u.SheetNames.push(v),u.Sheets[v]=g;var p=x(u,{bookType:n,bookSST:!1,type:"binary"});w.exports.saveAs(new Blob([_(p)],{type:"application/octet-stream"}),`${e}.${n}`)}export{F as export_json_to_excel,D as export_table_to_excel};
