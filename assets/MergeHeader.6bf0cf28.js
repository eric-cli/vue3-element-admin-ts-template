import{p as g,c as T}from"./index.a4f62dd8.js";import{a as y,r as c,D as V,o as h,j,h as l,w as a,u as b,b4 as B,af as L,b as k,M as s,x as i,l as v,V as A,Y as I,X as C,Z as M,a$ as N}from"./vendor.a1ba0c3f.js";/* empty css                */import{a as R}from"./article.ee3f6b9a.js";const P={class:"app-container"},$=s("Export"),H=v("i",{class:"el-icon-time"},null,-1),Z=y({setup(J){const x=c(),d=c([]),u=c(!0),_=c(!1),E=()=>{u.value=!0,R().then(o=>{d.value=o.data.lists,u.value=!1})},w=(o,r)=>r.map(n=>o.map(e=>e==="timestamp"?g(n[e]):n[e])),D=()=>{_.value=!0,T(()=>import("./Export2Excel.41632095.js"),["assets/Export2Excel.41632095.js","assets/FileSaver.min.41c9702c.js","assets/vendor.a1ba0c3f.js","assets/vendor.4f754953.css","assets/xlsx.5331d5b0.js"]).then(o=>{const r=[["Id","Main Information","","","Date"]],n=["","Title","Author","Readings",""],m=w(["id","title","author","pageviews","display_time"],d.value),f={multiHeader:r,header:n,merges:["A1:A2","B1:D1","E1:E2"],data:m};o.export_json_to_excel(f),_.value=!1})};return V(()=>{E()}),(o,r)=>{const n=A,e=I,m=C,p=M,f=N;return h(),j("div",P,[l(n,{loading:_.value,style:{"margin-bottom":"20px"},type:"primary",icon:b(B),onClick:D},{default:a(()=>[$]),_:1},8,["loading","icon"]),L((h(),k(p,{ref_key:"multipleTable",ref:x,data:d.value,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},{default:a(()=>[l(e,{align:"center",label:"Id",width:"95"},{default:a(t=>[s(i(t.$index),1)]),_:1}),l(e,{label:"Main Information",align:"center"},{default:a(()=>[l(e,{label:"Title"},{default:a(({row:t})=>[s(i(t.title),1)]),_:1}),l(e,{label:"Author",width:"110",align:"center"},{default:a(({row:t})=>[l(m,null,{default:a(()=>[s(i(t.author),1)]),_:2},1024)]),_:1}),l(e,{label:"Readings",width:"115",align:"center"},{default:a(({row:t})=>[s(i(t.pageviews),1)]),_:1})]),_:1}),l(e,{align:"center",label:"Date",width:"220"},{default:a(({row:t})=>[H,v("span",null,i(b(g)(t.timestamp,"{y}-{m}-{d} {h}:{i}")),1)]),_:1})]),_:1},8,["data"])),[[f,u.value]])])}}});export{Z as default};
